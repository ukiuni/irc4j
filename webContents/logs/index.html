<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>Log....</title>
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link
	href="http://getbootstrap.com/examples/starter-template/starter-template.css"
	rel="stylesheet">
<link href="http://bootswatch.com/readable/bootstrap.min.css"
	rel="stylesheet">
<link href="/js/google-code-prettify/prettify.css" rel="stylesheet">


</head>
<body>

	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse"
					data-target=".navbar-collapse">
					<span class="icon-bar"></span> <span class="icon-bar"></span> <span
						class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="#">Log...</a>
			</div>
			<!--/.nav-collapse -->
		</div>
	</div>

	<div class="container">
		<div class="page-header">
			<h2 id="leadArea">Log data</h2>
		</div>
		<p class="lead">
		<pre style="margin-top: 20px" class="prettyprint linenums"
			id="logArea">
			<span>loading...</span>
		</pre>
		</p>
		<p id="infoArea"></p>
	</div>

	<script src="/js/jquery-1.10.2.min.js"></script>
	<script src="/js/google-code-prettify/prettify.js"></script>
	<script src="/js/bootstrap.min.js"></script>
	<script src="/js/jsrender.min.js" type="text/javascript"></script>
	<script id="logTemplate" type="text/x-jsrender">{{time:createdAt}}&nbsp;{{>senderNickName}}&gt;{{>message}}
</script>
	<script id="leadTemplate" type="text/x-jsrender">Chat log at {{>channelName}} at {{date:date}}</script>
	<script id="infoTemplate" type="text/x-jsrender">This log is captured by {{>user}}</script>
	<script type="text/javascript">
		$.views.converters({
			date : function(val) {
				var date = new Date(val);
				var month = date.getMonth() + 1;
				var day = date.getDate();
				var hours = date.getHours();
				var minutes = date.getMinutes();
				if(month<10){month = "0" + month}
				if(day<10){day = "0" + date}
				if(hours<10){hours = "0" + hours}
				if(minutes<10){minutes = "0" + minutes}
				return date.getFullYear() + "/" + (month) + "/"
						+ day + " " + hours + ":"
						+ minutes;
			},
			time : function(val) {
				var date = new Date(val);
				var hours = date.getHours();
				var minutes = date.getMinutes();
				if(hours<10){hours = "0" + hours}
				if(minutes<10){minutes = "0" + minutes}
				return hours + ":" + minutes;
			}
		});
		if (location.hash){
			$(function() {
				$.getJSON(
						"/logs?k="
								+ location.hash.substring(1,
										location.hash.length), function(data) {
							if (0 == data.length) {
								$("#logArea").html("no data")
								return;
							} else {

							}

							$("#leadArea").html($("#leadTemplate").render(data));
							$("#infoArea").html($("#infoTemplate").render(data));
							$("#logArea").html($("#logTemplate").render(data.logs));
							prettyPrint();
						}).error(function(data) {
					$("#logArea").html("error " + data.textStatus);
				});
			})
		} else {
			$("#logArea").html("no log specified");
		}
	</script>
</body>
</html>